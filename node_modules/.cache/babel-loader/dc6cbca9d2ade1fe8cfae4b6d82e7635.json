{"ast":null,"code":"import _regeneratorRuntime from\"H:\\\\Licenta\\\\my-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"H:\\\\Licenta\\\\my-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"H:\\\\Licenta\\\\my-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect}from'react';import app from'firebase/app';import Firebase from'../Firebase/firebase';function Plans(){var db=app.firestore();var storage=app.storage();var gsReference=storage.refFromURL('gs://academie-90dfd.appspot.com/Profile.jpg');gsReference.getDownloadURL().then(function(url){// `url` is the download URL for 'images/stars.jpg'\n// This can be downloaded directly:\nvar xhr=new XMLHttpRequest();xhr.responseType='blob';xhr.onload=function(event){var blob=xhr.response;};xhr.open('GET',url);xhr.send();});var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),fileUrl=_React$useState2[0],setFileUrl=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),users=_React$useState4[0],setUsers=_React$useState4[1];var onFileChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,storageRef,fileRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];storageRef=app.storage().ref();fileRef=storageRef.child(file.name);_context.next=5;return fileRef.put(file);case 5:_context.t0=setFileUrl;_context.next=8;return fileRef.getDownloadURL();case 8:_context.t1=_context.sent;(0,_context.t0)(_context.t1);case 10:case\"end\":return _context.stop();}}},_callee);}));return function onFileChange(_x){return _ref.apply(this,arguments);};}();var onSubmit=function onSubmit(e){e.preventDefault();var username=e.target.username.value;if(!username){return;}db.collection(\"users\").doc(username).set({name:username,avatar:fileUrl});};useEffect(function(){var fetchUsers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var usersCollection;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return db.collection('users').get();case 2:usersCollection=_context2.sent;setUsers(usersCollection.docs.map(function(doc){return doc.data();}));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchUsers(){return _ref2.apply(this,arguments);};}();fetchUsers();},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:onSubmit},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",onChange:onFileChange}),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"username\",placeholder:\"Name\"}),/*#__PURE__*/React.createElement(\"button\",null,\"Submit\")),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"button\",null,/*#__PURE__*/React.createElement(\"a\",{href:\"https://firebasestorage.googleapis.com/v0/b/academie-90dfd.appspot.com/o/resurse%20site.zip?alt=media&token=7e387663-3a23-4a0c-b955-85aa1da9ba06\"},\"Download\"))),/*#__PURE__*/React.createElement(\"ul\",null,users.map(function(user){return/*#__PURE__*/React.createElement(\"li\",{key:user.name},/*#__PURE__*/React.createElement(\"img\",{width:\"100\",height:\"100\",src:user.avatar,alt:user.name}),/*#__PURE__*/React.createElement(\"p\",null,user.name));})));}export default Plans;","map":{"version":3,"sources":["H:/Licenta/my-app/src/components/Plans/index.js"],"names":["React","useEffect","app","Firebase","Plans","db","firestore","storage","gsReference","refFromURL","getDownloadURL","then","url","xhr","XMLHttpRequest","responseType","onload","event","blob","response","open","send","useState","fileUrl","setFileUrl","users","setUsers","onFileChange","e","file","target","files","storageRef","ref","fileRef","child","name","put","onSubmit","preventDefault","username","value","collection","doc","set","avatar","fetchUsers","get","usersCollection","docs","map","data","user"],"mappings":"0aAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,GAAP,KAAgB,cAAhB,CACA,MAAOC,CAAAA,QAAP,KAAqB,sBAArB,CAGA,QAASC,CAAAA,KAAT,EAAkB,CAChB,GAAMC,CAAAA,EAAE,CAAGH,GAAG,CAACI,SAAJ,EAAX,CACA,GAAIC,CAAAA,OAAO,CAAGL,GAAG,CAACK,OAAJ,EAAd,CACA,GAAIC,CAAAA,WAAW,CAAGD,OAAO,CAACE,UAAR,CAAmB,6CAAnB,CAAlB,CAEAD,WAAW,CAACE,cAAZ,GAA6BC,IAA7B,CAAkC,SAASC,GAAT,CAAc,CAC9C;AAEA;AACA,GAAIC,CAAAA,GAAG,CAAG,GAAIC,CAAAA,cAAJ,EAAV,CACAD,GAAG,CAACE,YAAJ,CAAmB,MAAnB,CACAF,GAAG,CAACG,MAAJ,CAAa,SAASC,KAAT,CAAgB,CAC3B,GAAIC,CAAAA,IAAI,CAAGL,GAAG,CAACM,QAAf,CACD,CAFD,CAGAN,GAAG,CAACO,IAAJ,CAAS,KAAT,CAAgBR,GAAhB,EACAC,GAAG,CAACQ,IAAJ,GAED,CAZD,EALgB,oBAmBcrB,KAAK,CAACsB,QAAN,CAAe,IAAf,CAnBd,oDAmBTC,OAnBS,qBAmBAC,UAnBA,0CAoBUxB,KAAK,CAACsB,QAAN,CAAe,EAAf,CApBV,qDAoBTG,KApBS,qBAoBFC,QApBE,qBAsBhB,GAAMC,CAAAA,YAAY,0FAAG,iBAAMC,CAAN,8IACbC,IADa,CACND,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CADM,CAEbC,UAFa,CAEA9B,GAAG,CAACK,OAAJ,GAAc0B,GAAd,EAFA,CAGbC,OAHa,CAGHF,UAAU,CAACG,KAAX,CAAiBN,IAAI,CAACO,IAAtB,CAHG,uBAIbF,CAAAA,OAAO,CAACG,GAAR,CAAYR,IAAZ,CAJa,oBAKnBL,UALmB,uBAKFU,CAAAA,OAAO,CAACxB,cAAR,EALE,sHAAH,kBAAZiB,CAAAA,YAAY,4CAAlB,CASA,GAAMW,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACV,CAAD,CAAM,CACrBA,CAAC,CAACW,cAAF,GACA,GAAMC,CAAAA,QAAQ,CAAGZ,CAAC,CAACE,MAAF,CAASU,QAAT,CAAkBC,KAAnC,CACA,GAAG,CAACD,QAAJ,CAAa,CACX,OACD,CACDnC,EAAE,CAACqC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BH,QAA3B,EAAqCI,GAArC,CAAyC,CACvCR,IAAI,CAAEI,QADiC,CAEvCK,MAAM,CAAEtB,OAF+B,CAAzC,EAID,CAVD,CAYAtB,SAAS,CAAC,UAAM,CACd,GAAM6C,CAAAA,UAAU,2FAAG,mLACazC,CAAAA,EAAE,CAACqC,UAAH,CAAc,OAAd,EAAuBK,GAAvB,EADb,QACXC,eADW,gBAEjBtB,QAAQ,CAACsB,eAAe,CAACC,IAAhB,CAAqBC,GAArB,CAAyB,SAAAP,GAAG,CAAI,CACvC,MAAOA,CAAAA,GAAG,CAACQ,IAAJ,EAAP,CACD,CAFQ,CAAD,CAAR,CAFiB,wDAAH,kBAAVL,CAAAA,UAAU,2CAAhB,CAMAA,UAAU,GACX,CARQ,CAQN,EARM,CAAT,CAWA,mBACE,qDACE,4BAAM,QAAQ,CAAER,QAAhB,eACE,6BAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAEX,YAA7B,EADF,cAEE,6BAAO,IAAI,CAAC,MAAZ,CAAmB,IAAI,CAAC,UAAxB,CAAmC,WAAW,CAAC,MAA/C,EAFF,cAGE,2CAHF,CADF,cAME,6CACE,+CACE,yBAAG,IAAI,CAAE,kJAAT,aADF,CADF,CANF,cAaE,8BACKF,KAAK,CAACyB,GAAN,CAAU,SAACE,IAAD,CAAU,CACnB,mBACA,0BAAI,GAAG,CAAEA,IAAI,CAAChB,IAAd,eACE,2BAAK,KAAK,CAAC,KAAX,CAAiB,MAAM,CAAC,KAAxB,CAA8B,GAAG,CAAEgB,IAAI,CAACP,MAAxC,CAAgD,GAAG,CAAEO,IAAI,CAAChB,IAA1D,EADF,cAEE,6BAAIgB,IAAI,CAAChB,IAAT,CAFF,CADA,CAMD,CAPA,CADL,CAbF,CADF,CA0BD,CAED,cAAehC,CAAAA,KAAf","sourcesContent":["import React, { useEffect } from 'react';\r\nimport app from 'firebase/app';\r\nimport Firebase from '../Firebase/firebase';\r\n\r\n \r\nfunction Plans () {\r\n  const db = app.firestore()\r\n  var storage = app.storage();\r\n  var gsReference = storage.refFromURL('gs://academie-90dfd.appspot.com/Profile.jpg')\r\n\r\n  gsReference.getDownloadURL().then(function(url) {\r\n    // `url` is the download URL for 'images/stars.jpg'\r\n  \r\n    // This can be downloaded directly:\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.responseType = 'blob';\r\n    xhr.onload = function(event) {\r\n      var blob = xhr.response;\r\n    };\r\n    xhr.open('GET', url);\r\n    xhr.send();\r\n  \r\n  });\r\n\r\n  const [fileUrl, setFileUrl] = React.useState(null)\r\n  const [users, setUsers] = React.useState([])\r\n\r\n  const onFileChange = async(e) => {\r\n    const file = e.target.files[0]\r\n    const storageRef = app.storage().ref()\r\n    const fileRef = storageRef.child(file.name)\r\n    await fileRef.put(file)\r\n    setFileUrl(await fileRef.getDownloadURL())\r\n \r\n  }\r\n\r\n  const onSubmit = (e) =>{\r\n    e.preventDefault()\r\n    const username = e.target.username.value;\r\n    if(!username){\r\n      return\r\n    }\r\n    db.collection(\"users\").doc(username).set({\r\n      name: username,\r\n      avatar: fileUrl\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    const fetchUsers = async () => {\r\n      const usersCollection = await db.collection('users').get()\r\n      setUsers(usersCollection.docs.map(doc => {\r\n        return doc.data()\r\n      }))\r\n    }\r\n    fetchUsers()\r\n  }, [])\r\n\r\n\r\n  return(\r\n    <>\r\n      <form onSubmit={onSubmit}>\r\n        <input type=\"file\" onChange={onFileChange}/>\r\n        <input type=\"text\" name=\"username\" placeholder=\"Name\"/>\r\n        <button>Submit</button>\r\n      </form>\r\n      <form >\r\n        <button>\r\n          <a href={\"https://firebasestorage.googleapis.com/v0/b/academie-90dfd.appspot.com/o/resurse%20site.zip?alt=media&token=7e387663-3a23-4a0c-b955-85aa1da9ba06\"}>\r\n          Download\r\n        </a>\r\n        </button>     \r\n      </form>\r\n      <ul>\r\n          {users.map((user) => {\r\n            return (\r\n            <li key={user.name}>\r\n              <img width=\"100\" height=\"100\" src={user.avatar} alt={user.name}/>\r\n              <p>{user.name}</p>\r\n              </li>\r\n          );\r\n          })}\r\n      </ul>\r\n    </>\r\n  );\r\n}\r\n \r\nexport default Plans;"]},"metadata":{},"sourceType":"module"}